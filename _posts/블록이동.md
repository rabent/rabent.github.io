#include <string>
#include <vector>
#include <queue>

using namespace std;
//0 left 1 right 2 up 3 down

struct part {
    int a; int b; int dir;
};

struct robot {
    part part1; part part2;
    int count=0;
};

int solution(vector<vector<int>> board) {
    int answer = 100000;
    bool visit[100][100][4] = {false};
    queue<robot> q; 
    robot tmp={{0,0,0}, {0,1,1}, 0};
    visit[0][0][0]=true; visit[0][1][1]=true;
    q.push(tmp);
    while(!q.empty()) {
        robot r=q.front(); q.pop();
        part p1=r.part1; part p2=r.part2;
        if(p1.a==board.size()-1 && p1.b==board.size()-1) {
            if(answer>r.count) answer=r.count;
            break;
        }
        if(p2.a==board.size()-1 && p2.b==board.size()-1) {
            if(answer>r.count) answer=r.count;
            break;
        }
        int count=r.count+1;
        if(p1.dir==0) {
            if(p2.b+1<board.size() && board[p2.a][p2.b+1]!=1) {
                robot tmp={{p1.a, p1.b+1, 0}, {p2.a, p2.b+1, 1}, count};
                if(visit[p1.a][p1.b+1][0]==false) {
                    q.push(tmp);
                    visit[p1.a][p1.b+1][0]=true;
                    visit[p2.a][p2.b+1][1]=true;                }
            }
            if(p1.b-1>=0 && board[p1.a][p1.b-1]!=1) {
                robot tmp={{p1.a, p1.b-1, 0}, {p2.a, p2.b-1, 1}, count};
                if(visit[p1.a][p1.b-1][0]==false) {
                    q.push(tmp);
                    visit[p1.a][p1.b-1][0];
                    visit[p2.a][p2.b-1][0];
                }
            }
            if(p1.a-1>=0 && board[p1.a-1][p1.b]!=1 && board[p2.a-1][p2.b]!=1) {
                robot tmp={{p1.a-1, p1.b, 0}, {p2.a-1, p2.b, 1}, count};
                if(visit[p1.a-1][p1.b][0]==false) {
                    q.push(tmp);
                    visit[p1.a-1][p1.b][0];
                    visit[p2.a-1][p2.b][0];
                }
                tmp={{p1.a-1, p1.b, 2}, {p1.a, p1.b, 3}, count};
                if(visit[p1.a-1][p1.b][2]==false) {
                    q.push(tmp);
                    visit[p1.a-1][p1.b][2]=true;
                    visit[p1.a][p1.b][3]=true;
                }
                tmp={{p2.a-1,p2.b, 2}, {p2.a, p2.b, 3}, count};
                if(visit[p2.a-1][p2.b][2]==false) {
                    q.push(tmp);
                    visit[p2.a-1][p2.b][2]=true;
                    visit[p2.a][p2.b][3]=true;
                }
            }
            if(p1.a+1<board.size() && board[p1.a+1][p1.b]!=1 && board[p2.a+1][p2.b]!=1) {
                robot tmp={{p1.a+1, p1.b, 0}, {p2.a+1, p2.b, 1}, count};
                if(visit[p1.a+1][p1.b][0]==false) {
                    q.push(tmp);
                    visit[p1.a+1][p1.b][0];
                    visit[p2.a+1][p2.b][0];
                }
                tmp={{p1.a, p1.b, 2}, {p1.a+1, p1.b, 3}, count};
                if(visit[p1.a][p1.b][2]==false) {
                    q.push(tmp);
                    visit[p1.a][p1.b][2]=true;
                    visit[p1.a+1][p1.b][3]=true;
                }
                tmp={{p2.a,p2.b, 2}, {p2.a+1, p2.b, 3}, count};
                if(visit[p2.a][p2.b][2]==false) {
                    q.push(tmp);
                    visit[p2.a][p2.b][2]=true;
                    visit[p2.a+1][p2.b][3]=true;
                }
            }
        }
        else if(p1.dir==2) {
            if(p2.a+1<board.size() && board[p2.a+1][p2.b]!=1) {
                robot tmp={{p1.a+1, p1.b, 2}, {p2.a+1, p2.b, 3}, count};
                if(visit[p1.a+1][p1.b][2]==false) {
                    q.push(tmp);
                    visit[p1.a+1][p1.b][2]=true;
                    visit[p2.a+1][p2.b][3]=true;                }
            }
            if(p1.a-1>=0 && board[p1.a-1][p1.b]!=1) {
                robot tmp={{p1.a-1, p1.b, 2}, {p2.a-1, p2.b, 3}, count};
                if(visit[p1.a-1][p1.b][2]==false) {
                    q.push(tmp);
                    visit[p1.a-1][p1.b][2];
                    visit[p2.a-1][p2.b][3];
                }
            }
            if(p1.b-1>=0 && board[p1.a][p1.b-1]!=1 && board[p2.a][p2.b-1]!=1) {
                robot tmp={{p1.a, p1.b-1, 2}, {p2.a, p2.b-1, 3}, count};
                if(visit[p1.a][p1.b-1][2]==false) {
                    q.push(tmp);
                    visit[p1.a][p1.b-1][2];
                    visit[p2.a][p2.b-1][3];
                }
                tmp={{p1.a, p1.b-1, 0}, {p1.a, p1.b, 1}, count};
                if(visit[p1.a][p1.b-1][0]==false) {
                    q.push(tmp);
                    visit[p1.a][p1.b-1][0]=true;
                    visit[p1.a][p1.b][1]=true;
                }
                tmp={{p2.a,p2.b-1, 0}, {p2.a, p2.b, 1}, count};
                if(visit[p2.a][p2.b-1][0]==false) {
                    q.push(tmp);
                    visit[p2.a][p2.b-1][0]=true;
                    visit[p2.a][p2.b][1]=true;
                }
            }
            if(p1.b+1<board.size() && board[p1.a][p1.b+1]!=1 && board[p2.a][p2.b+1]!=1) {
                robot tmp={{p1.a, p1.b+1, 2}, {p2.a, p2.b+1, 3}, count};
                if(visit[p1.a][p1.b+1][2]==false) {
                    q.push(tmp);
                    visit[p1.a][p1.b+1][2];
                    visit[p2.a][p2.b+1][3];
                }
                tmp={{p1.a, p1.b, 0}, {p1.a, p1.b+1, 1}, count};
                if(visit[p1.a][p1.b][0]==false) {
                    q.push(tmp);
                    visit[p1.a][p1.b][0]=true;
                    visit[p1.a][p1.b+1][1]=true;
                }
                tmp={{p2.a,p2.b, 0}, {p2.a, p2.b+1, 1}, count};
                if(visit[p2.a][p2.b][0]==false) {
                    q.push(tmp);
                    visit[p2.a][p2.b][0]=true;
                    visit[p2.a][p2.b+1][1]=true;
                }
            }
        }
    }
    return answer;
}